# Домашнее задание к занятию "Jenkins"

## Подготовка к выполнению

|                                        Номер и описание задачи                                        | Описание выполняемых действий                                                                                                                                                                                                                                                                                                                         | Скриншоты                                                                                 |
| :-----------------------------------------------------------------------------------------------------------------------: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------- |
|                       1. Создать две VM<br />для jenkins-master и<br />jenkins agent                       | Созданы 2 VM в YC                                                                                                                                                                                                                                                                                                                                                        |                                                                                                    |
| 2. На созданные VM установить<br />и сконфигурировать Jenkins и<br />Jenkins-agent | Создан простой playbook для установки jenkins-master<br />и jenkins-agent.<br />Сам playbook выложен в директорию src<br />рядом с данным README файлом.                                                                                                                                                        |                                                                                                    |
|                                     3. Запустить Мастер и агент                                     | Установлены и запущены мастер и агент                                                                                                                                                                                                                                                                                                            |                                                                                                    |
|                           4. Выполнить первоначальную настройку                           | Проведена первоначальная конфигурация<br />мастера.<br />Создан агент agent-lxd-1 и настроено подключение<br />этого агента к мастеру.<br />На агенте заранее было настроено окружение для<br />проведения тестов molecule. | ![1736003902153](image/README/1736003902153.png)<br />![1736005367820](image/README/1736005367820.png) |

## Основная часть

|                                                                          Номер и описание задачи                                                                          | Описание выполняемых действий                                                                                                                                                                                                                                                                                                                                                                                                                    | Скриншоты                                                                                                                                                                                                                                                                                                 |
| :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
|                  1. Создать freestyle job, которая<br />будет запускать molecule test из любого<br />репозитория с ролью                  | Создана freestule джоба с именем<br />Freestyle molecule test, и настроено<br />тестирование моей роли vector.                                                                                                                                                                                                                                                                                                             | ![1736005894073](image/README/1736005894073.png)<br />![1736072042556](image/README/1736072042556.png)<br />![1736072069803](image/README/1736072069803.png)<br />![1736072097325](image/README/1736072097325.png)<br />![1736072113179](image/README/1736072113179.png)                                                     |
| 2. Создать Declarative Pipeline Job,<br />которая будет запускать тесты<br />molecule из любого моего репозитория<br />с ролью. | Создана declarative pipeline джоба,<br />которая клонирует репозиторий с ролью<br />vector и запускает тесты molecule.<br />Указана метка агента.                                                                                                                                                                                                                                             | ![1736073809839](image/README/1736073809839.png)<br />![1736074241328](image/README/1736074241328.png)<br />![1736074422482](image/README/1736074422482.png)<br />![1736074438186](image/README/1736074438186.png)<br />![1736074471808](image/README/1736074471808.png)                                                     |
|                                     3. Перенести Declarative Pipline в<br />репозиторий с ролью в файл <br />Jenkinsfile                                     | В репозиторий роли добавил Jenkinsfile                                                                                                                                                                                                                                                                                                                                                                                                               | ![1736075233933](image/README/1736075233933.png)                                                                                                                                                                                                                                                                     |
|                                             4. Создать Multibranch Pipeline на<br />запуск Jenkinsfile из репозитория                                             | Создан Multibranch Pipeline для запуска<br />Jenkinsfile из репозитория с моей ролью<br />vector.<br />Для тестирования добавлена новая ветка<br />(example_build).<br />При повторном сканировании репозитория<br />через Jenkins ветка "подтянулась" и<br />запустилась сборка из Jenkinsfile с этой ветки | ![1736075250940](image/README/1736075250940.png)<br />![1736075493794](image/README/1736075493794.png)<br />![1736075574182](image/README/1736075574182.png)<br />![1736075758560](image/README/1736075758560.png)<br />![1736076120600](image/README/1736076120600.png)<br />![1736076217762](image/README/1736076217762.png) |
|                                            5. Создать Scripted Pipeline, наполнив его<br />скриптом из примера.                                            | Создал pipeline job с именем Scripted pipeline<br />И добавил в него скрипт из примера.                                                                                                                                                                                                                                                                                                                                            | ![1736078947608](image/README/1736078947608.png)                                                                                                                                                                                                                                                                     |
|                                                    6. Внести изменения для обработки<br />логики prod_run                                                    | Внес в скрипт логику обработки значения<br />prod_run.<br />Добавил указание параметра prod_run при <br />запуске сборки.                                                                                                                                                                                                                                                                        | ![1736079783816](image/README/1736079783816.png)<br />![1736079806177](image/README/1736079806177.png)                                                                                                                                                                                                                 |
|                                    7. Проверить работоспособность<br />и выложить скрипт в реп с ролью.                                    | Проверена работоспособность<br />Выложил файл с скриптом в репозиторий.                                                                                                                                                                                                                                                                                                                                           | ![1736079905195](image/README/1736079905195.png)<br />![1736079920088](image/README/1736079920088.png)<br />![1736080151269](image/README/1736080151269.png)                                                                                                                                                             |
|                                                                 8. Приложить ссылку на репозиторий                                                                 | Ссылка: [link](https://github.com/Torrmund/ansible_vector_role)                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                    |
