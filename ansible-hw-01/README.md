# Домашнее задание "Введение в Ansible"

## Подготовка к выполнению

|                                                            Номер и описание задачи                                                            | Описание выполняемых действий                                                        | Скриншоты                             |
| :---------------------------------------------------------------------------------------------------------------------------------------------------------------: | --------------------------------------------------------------------------------------------------------------- | ---------------------------------------------- |
|                                              1. Установить ansible<br />версии 2.10 или выше                                              | Ansible установлен глобально в ОС,<br /> на которой выполняется ДЗ. | ![1730290194484](image/README/1730290194484.png) |
| 2. Скопировать исходники<br />из репозитория mnt-homeworks.<br />В частности исходники к данному ДЗ | Скопированы исходники.                                                                      | ![1730290258088](image/README/1730290258088.png) |

## Основная часть

|                                                                                                              Номер и описание задачи                                                                                                              | Описание выполняемых действий                                                                                                                                                                                                                                                                                                                                                               | Скриншоты                                                                                 |
| :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------- |
|                       1. Запустить playbook<br />на окружении из test.yml.<br />Зафиксировать, какое значение <br />имеет факт some_fact <br />для указанного хоста.                       | Запущен playbook.<br />Значение some_fact указано <br />в результате таски Print fact.                                                                                                                                                                                                                                                                                           | ![1730290690641](image/README/1730290690641.png)                                                     |
|                                                 2. Найти файл с переменными<br />где указывается some_fact <br />и заменить значение на <br />all default fact                                                 | some_fact задается<br />в файле group_vars/all/examp.yml<br />Заменил значение переменной и<br />заново проиграл playbook                                                                                                                                                                                                                                        | ![1730291027075](image/README/1730291027075.png)<br />![1730291082237](image/README/1730291082237.png) |
|                                   3. Воспользоваться подготовленым окружением<br /> или создать свое для проведения <br />дальнейших испытаний                                   | Созданы окружение:<br />Созданы контейнеры almalinux9 и ubuntu22<br /> на базе образов с установленным <br />в них python3, т.к. ansible треубет наличия<br />на managed nodes установленного<br />интерпретатора python.<br />Скорректирован инвентарь prod.yml                | ![1730295226111](image/README/1730295226111.png)<br />![1730295196662](image/README/1730295196662.png) |
|                                                                   4. Запустить playbook на окружении<br />prod.yml<br />Зафиксировать значения some_facts.                                                                   | Запущен playbook на инвентаре<br />prod.yml<br />Значения some_fact для хостов указаны<br />в результатах выполнения таски Print fact.<br />Значения этой переменной задаются через<br />групповые переменные в файлах<br />group_vars/deb/examp.yml и<br />group_vars/el/examp.yml | ![1730295280643](image/README/1730295280643.png)                                                     |
|                                                 5. Сделать так, чтобы some_fact имели значения<br />deb default fact и el default fact для разных<br />групп хостов                                                 | Изменено значение переменной some_fact<br />в файлах<br />group_vars/deb/examp.yml и<br />group_vars/el/examp.yml                                                                                                                                                                                                                                                                    | ![1730295684886](image/README/1730295684886.png)<br />![1730295697275](image/README/1730295697275.png) |
|                                6. Запустить playbook на инвентаре<br />prod.yml<br />Удостовериться, что выдаются корректные<br />значения для всех хостов                                | Запущен playbook                                                                                                                                                                                                                                                                                                                                                                                                | ![1730295719519](image/README/1730295719519.png)                                                     |
|                                                                   7. При помощи vault<br />зашифровать факты <br />для групп deb и el с паролем netology                                                                   | Зашифрованы файлы с переменными                                                                                                                                                                                                                                                                                                                                                            | ![1730298222663](image/README/1730298222663.png)<br />![1730298235430](image/README/1730298235430.png) |
| 8. Запустить playbook на инвентаре prod.yml<br />Необходимо, чтобы ansible запросил пароль<br />от зашифрованных переменных.<br />Убедиться в работоспособности. | Запущен playbook с ключом --ask-vault-pass<br />Проверена работоспособность.                                                                                                                                                                                                                                                                                                   | ![1730296550502](image/README/1730296550502.png)                                                     |
|                                 9. Через ansible-doc посмотреть<br />список плагинов<br />для подключения. Выбрать подходящий<br />для работы на control node.                                 | Просмотрен список доступных плагинов.<br />Выбран плагин local.                                                                                                                                                                                                                                                                                                           | ![1730296868281](image/README/1730296868281.png)                                                     |
|                 10. В инвентарь prod.yml добавить новую<br />группу хостов с именем local. В ней<br />разместить localhost с необходимым<br />типом подключения.                 | В инвентарь prod.yml добавлена группа<br />и хост.                                                                                                                                                                                                                                                                                                                                       | ![1730297161975](image/README/1730297161975.png)                                                     |
|                                                   11. Запустить playbook. Удостовериться, что<br />переменные берутся из коррекных<br />источников.                                                   | Запущен playbook.                                                                                                                                                                                                                                                                                                                                                                                               | ![1730297250715](image/README/1730297250715.png)                                                     |

## Необязательная часть

|                                                                              Номер и описание задачи                                                                              | Описание выполняемых действий                                                                                                                                                                                                                                                                                                                    | Скриншоты                                                                                                                                     |
| :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ |
|                                                                1. Расшифровать все файлы с переменными                                                                | Расшифрованы файлы с переменными.                                                                                                                                                                                                                                                                                                              | ![1730298305188](image/README/1730298305188.png)<br />![1730298320731](image/README/1730298320731.png)<br />![1730298335678](image/README/1730298335678.png) |
|                                                2. Зашифровать значение переменной<br />some_fact для группы all.                                                | Внесены изменения в файл с<br />групповыми переменными для группы<br />all.<br />Зашифрован и подставлено значение.                                                                                                                                                                       | ![1730298404817](image/README/1730298404817.png)<br />![1730298389258](image/README/1730298389258.png)                                                     |
|                       3. Запустить playbook и убедиться,<br />что для нужных хостов применяется<br />корректный fact.                       | Запущен playbook.                                                                                                                                                                                                                                                                                                                                                    | ![1730297787058](image/README/1730297787058.png)                                                                                                         |
|                     4. Добавить новую группу хостов Fedora.<br />Самостоятельно придумать для нее<br />переменную.                     | Добавлена группа Fedora.<br />Добавлена переменная для этой группы.                                                                                                                                                                                                                                                          | ![1730298491327](image/README/1730298491327.png)<br />![1730298505455](image/README/1730298505455.png)<br />![1730298713520](image/README/1730298713520.png) |
| 5. Написать bash скрипт для автоматизации<br />запуска контейнеров, запуска ansible-playbook <br />и остановку контейнеров | Для того, чтобы скрипт работал корректно<br />, внес изменения в инвентарь согласно <br />измененному окружению.<br />Скрипт размещен в директории с playbook<br />и запускать его следует из этой же<br />директории. | ![1730301985145](image/README/1730301985145.png)<br />![1730302009866](image/README/1730302009866.png)<br />![1730302033956](image/README/1730302033956.png) |
