# Домашнее задание к занятию "Kubernetes. Причины появления. Команда kubectl"

## Подготовка к выполнению

### Установка MicroK8S и kubectl

| Описание выполняемых действий                                                                              | Скриншоты                             |
| ------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------- |
| 1. Поднял новую ВМ в YC                                                                                                 | ![1738089955275](image/README/1738089955275.png) |
| 2. Подключился к новой ВМ по SSH.<br />Выполнил команды для установки <br />MicroK8S | ![1738091817452](image/README/1738091817452.png) |
| 3. Поднял новую ВМ в YC под kubectl                                                                                  | ![1738092530079](image/README/1738092530079.png) |
| 4. Подключился к новой ВМ по SSH.<br />Выполнил команды для установки <br />kubectl  | ![1738093089000](image/README/1738093089000.png) |

## Задание 1

| Номер и описание задачи                                                            | Описание выполняемых действий                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Скриншоты                                                                                                                                                                                                                                                                                                                                                     |
| ------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1. Установить MicroK8S                                                                       | Установка произведена на этапе подготовки                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                                                        |
| 2. Установить dashboard                                                                      | MicroK8s предоставляет встроенный способ установки<br />Kubernetes Dashboard.<br />Активируем addon командой<br />microK8S enable dashboard                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | ![1738093281695](image/README/1738093281695.png)                                                                                                                                                                                                                                                                                                                         |
| 3. Организовать доступ к<br />дашборду через внешний <br />IP. | Получаем токен доступа к Dashboard:<br />Выполняем microk8s kubectl -n kube-system get secret<br /><br />Выполняем команду для отображения секретов и копируем <br />себе значение токена dashboard.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | ![1738093638604](image/README/1738093638604.png)<br />![1738093824970](image/README/1738093824970.png)<br />![1738093843127](image/README/1738093843127.png)                                                                                                                                                                                                                 |
|                                                                                                        | Настраиваем доступ к dashboard через внешний IP:<br />По умолчанию, dashboard доступен только внутри кластера.<br />Чтобы открыть доступ к нему через внешний IP, выполняем <br />следующие шаги:<br />- Генерируем сертификат для внешнего IP адреса при помощи<br />openssl<br />- Создаем секрет в MicroK8S, используя полученный ранее<br />сертификат.<br />- Используем NodePort для доступа к дашборду.<br />Меняем тип с ClusterIP на NodePort для сервиса kubernetes-<br />dashboard.<br />- Смотрим порт, который был прокинут к дашборду<br />- Открываем в браузере дашборд и авторизуемся по токену. | ![1738094056453](image/README/1738094056453.png)<br />![1738094153832](image/README/1738094153832.png)<br />![1738094461438](image/README/1738094461438.png)<br />![1738094713991](image/README/1738094713991.png)<br />![1738094779246](image/README/1738094779246.png)<br />![1738094802951](image/README/1738094802951.png)<br />![1738094922075](image/README/1738094922075.png) |

## Задание 2

| Номер и описание задачи                                         | Описание выполняемых действий                                                                                                                                                         | Скриншоты                                                                                                                                     |
| ----------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 1. Установить kubectl                                                     | kubectl был установлен на машину<br />в рамках подготовки                                                                                                                  |                                                                                                                                                        |
| 2. Настроить подключение к кластеру                    | Копируем конфиг кластера и формируем<br />файл конфига для kubectl<br /><br />Проверяем, что kubectl подключается к<br />кластеру | ![1738095247073](image/README/1738095247073.png)<br />![1738095252011](image/README/1738095252011.png)<br />![1738095311921](image/README/1738095311921.png) |
| 3. Подключиться к дашборду с помощью<br />port-forward | Находим имя пода дашборда<br /><br />Запускаем port-forward<br /><br />Проверяем через curl подключение к<br />дашборду                         | ![1738095396455](image/README/1738095396455.png)<br />![1738096200412](image/README/1738096200412.png)<br />![1738096772134](image/README/1738096772134.png) |
