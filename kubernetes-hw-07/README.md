# Домашнее задание к занятию "Хранение в K8S. Часть 2"

## Задание 1

| Номер и описание задачи                                                                                                                                                                                                                                                             | Описание выполняемых действий                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Скриншоты                                                                                                                                     |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 1. Создать Deployment приложения, состоящего из контейнеров<br />buxybox и multitool.                                                                                                                                                                          | Описал манифест deployment, состоящего<br />из контейнеров busybox и multitool, использующих<br />PV.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | ![1739286361406](image/README/1739286361406.png)                                                                                                         |
| 2. Создать PV и PVC для подключения папки на локальной ноде,<br />которая будет использована в поде.                                                                                                                             | Описал манифесты PV и PVC.<br /><br />Применил манифесты.<br /><br />Убедился, что все объекты созданы.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | ![1739286442773](image/README/1739286442773.png)<br />![1739286480484](image/README/1739286480484.png)<br />![1739286536732](image/README/1739286536732.png) |
| 3. Продемонстрировать, что multitool может читать файл, в который<br />busybox пишет каждые 5 секунд в общей директории.                                                                                                   | Удостоверился, что multitool может читать файл, в<br />который busybox записывает информацию.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | ![1739286631344](image/README/1739286631344.png)                                                                                                         |
| 4. Удалить Deployment и PVC. Продемонстрировать, что после этого<br />произошло с PV. Объяснить почему.                                                                                                                                 | Удалил созданные ранее deployment и PVC.<br />Посмотрел, что стало с PV и данными на нем.<br /><br />PV перешел из статуса bound в статус Released. Это <br />означает, что PV больше не имеет связанного PVC,<br />но сам PV не удален из кластера и может быть <br />использован повторно.<br /><br />Данные контейнеров в PV при этом остались, потому<br />как политика возврата (persistentVolumeReclaimPolicy)<br />установлена на Retain | ![1739286881251](image/README/1739286881251.png)                                                                                                         |
| 5. Продемонстрировать, что файл сохранился на локальном диске<br />ноды. Удалить PV. Продемонстрировать что произошло с файлом<br />после удаления PV. Объяснить почему. | Удалил созданный ранее PV.<br /><br />После удаления PV, файл на диске остался, потому как<br />PV был создан с политикой Retain, которая не удаляет<br />данные при удалении PV.                                                                                                                                                                                                                                                                                                                                                                                            | ![1739287214764](image/README/1739287214764.png)                                                                                                         |
| 6. Предоставить манифесты.                                                                                                                                                                                                                                                         | Манифесты выложил в директорию src<br />рядом с данным readme                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                        |

## Задание 2

| Номер и описание задачи                                                                                                                                                                      | Описание выполняемых действий                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Скриншоты                                                                                                                                                                                                                                              |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1. Включить и настроить NFS-сервер на MicroK8S.                                                                                                                                        | Установил NFS сервер по инструкции из<br />документации:<br />https://microk8s.io/docs/how-to-nfs                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | ![1739288041678](image/README/1739288041678.png)                                                                                                                                                                                                                  |
| 2. Создать Deployment приложения, состоящего из<br />multitool, и подключить к нему PV, созданный автоматически<br />на сервере NFS. | Описал манифест storageClass.<br />Применил манифест. Убедился, что SC <br />создался.<br /><br />Описал манифест PVC, который будет<br />динамически запрашивать PV на<br />NFS-сервере.<br />Применил манифест. Убедился, что PVC<br />создан.<br /><br />Описал манифест Deployment.<br />Применил манифест.<br />Убедился, что под поднят.                                                                                                                                                               | ![1739292313578](image/README/1739292313578.png) <br />![1739289950620](image/README/1739289950620.png)<br />![1739291637089](image/README/1739291637089.png)<br />![1739292339454](image/README/1739292339454.png)<br />![1739291852496](image/README/1739291852496.png) |
| 3. Продемонстрировать возможность чтения и записи файла внутри пода                                                                                     | Подключился к командной оболочке<br />контейнера.<br /><br />Проверил запись в файл на подключенном<br />PV и чтение из этого файла.<br /><br />Проверил наличие файла на самом сервере.<br /><br />Удалил созданный ранее Deployment и PVC.<br />Убедился, что созданный динамически PV<br />также удалился.<br /><br />Проверил файлы на сервере. Убедился, что<br />файлы удалились согласно примененной к <br />SC политике. | ![1739292480621](image/README/1739292480621.png)<br />![1739292546356](image/README/1739292546356.png)<br />![1739292692942](image/README/1739292692942.png)<br />![1739292748922](image/README/1739292748922.png)                                                      |
| 4. Предоставить манифесты                                                                                                                                                                   | Манифесты выложил в директорию src<br />рядом с данным readme                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                 |
